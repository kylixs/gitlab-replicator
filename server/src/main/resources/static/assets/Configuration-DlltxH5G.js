import{c as E}from"./client-C0jSVIxo.js";import{d as W,f as v,y as O,h as q,k as A,b as l,w as o,r as d,E as V,a as s,l as H,j as m,c as x,t as r,o as p,_ as z}from"./index-WE4AwvtF.js";const T={getConfig(){return E.get("/config/all")},updateConfig(b){return E.post("/config/all",b)},testConnection(b){return E.post("/config/test-connection",null,{params:{type:b}})}},J={class:"configuration"},K={class:"card-header"},Q={class:"header-actions"},X={class:"config-section"},Y={class:"instance-config"},Z={key:0,class:"test-result"},ee={class:"instance-config"},le={key:0,class:"test-result"},te={class:"config-section"},ne={class:"input-hint"},oe={class:"config-section"},se={class:"input-hint"},ae={class:"config-section"},ue={class:"config-section"},de={class:"input-hint"},re=W({__name:"Configuration",setup(b){const h=v(!1),k=v(!1),R=v(!1),U=v(!1),i=v(null),c=v(null),t=O({gitlab:{source:{url:"",token:""},target:{url:"",token:""}},scanSettings:{incrementalInterval:3e5,fullScanCron:"0 0 2 * * ?",enabled:!0},syncSettings:{syncInterval:300,concurrency:5},defaultSyncRules:{method:"pull_sync",excludeArchived:!0,excludeEmpty:!0,excludePattern:"^temp/.*"},thresholds:{delayWarningHours:1,delayCriticalHours:24,maxRetryAttempts:3,timeoutSeconds:300}}),$=async()=>{h.value=!0;try{const a=await T.getConfig();Object.assign(t,a.data)}catch(a){V.error("Failed to load configuration"),console.error("Load config failed:",a)}finally{h.value=!1}},P=async()=>{k.value=!0;try{await T.updateConfig(t),V.success("Configuration saved successfully")}catch(a){V.error("Failed to save configuration"),console.error("Save config failed:",a)}finally{k.value=!1}},L=async a=>{a==="source"?(R.value=!0,i.value=null):(U.value=!0,c.value=null);try{const e=await T.testConnection(a);a==="source"?i.value=e.data:c.value=e.data,e.data.connected?V.success(`${a} GitLab connection successful`):V.error(`${a} GitLab connection failed`)}catch(e){a==="source"?i.value={connected:!1,error:"Connection test failed"}:c.value={connected:!1,error:"Connection test failed"},V.error(`Failed to test ${a} connection`),console.error("Test connection failed:",e)}finally{a==="source"?R.value=!1:U.value=!1}},G=a=>{const e=a/1e3;if(e<60)return`${e}s`;const g=e/60;return g<60?`${g}m`:`${g/60}h`},M=a=>{if(a<60)return`${a}s`;const e=a/60;return e<60?`${e}m`:`${e/60}h`};return q(()=>{$()}),(a,e)=>{const g=d("Refresh"),w=d("el-icon"),_=d("el-button"),N=d("Check"),S=d("el-divider"),y=d("el-input"),u=d("el-form-item"),C=d("el-tag"),I=d("el-switch"),f=d("el-input-number"),F=d("el-option"),j=d("el-select"),B=d("el-form"),D=d("el-card");return p(),A("div",J,[l(D,{class:"config-card"},{header:o(()=>[s("div",K,[e[21]||(e[21]=s("h2",null,"System Configuration",-1)),s("div",Q,[l(_,{onClick:$,loading:h.value},{default:o(()=>[l(w,null,{default:o(()=>[l(g)]),_:1}),e[19]||(e[19]=m(" Refresh ",-1))]),_:1},8,["loading"]),l(_,{type:"primary",onClick:P,loading:k.value},{default:o(()=>[l(w,null,{default:o(()=>[l(N)]),_:1}),e[20]||(e[20]=m(" Save Configuration ",-1))]),_:1},8,["loading"])])])]),default:o(()=>[l(B,{model:t,"label-width":"200px"},{default:o(()=>[s("div",X,[e[26]||(e[26]=s("h3",null,"GitLab Instances",-1)),l(S),s("div",Y,[e[23]||(e[23]=s("h4",null,"Source GitLab",-1)),l(u,{label:"URL"},{default:o(()=>[l(y,{modelValue:t.gitlab.source.url,"onUpdate:modelValue":e[0]||(e[0]=n=>t.gitlab.source.url=n),placeholder:"http://localhost:8000"},null,8,["modelValue"])]),_:1}),l(u,{label:"Access Token"},{default:o(()=>[l(y,{modelValue:t.gitlab.source.token,"onUpdate:modelValue":e[1]||(e[1]=n=>t.gitlab.source.token=n),type:"password","show-password":"",placeholder:"glpat-****"},null,8,["modelValue"])]),_:1}),l(u,null,{default:o(()=>[l(_,{onClick:e[2]||(e[2]=n=>L("source")),loading:R.value},{default:o(()=>[...e[22]||(e[22]=[m(" Test Connection ",-1)])]),_:1},8,["loading"]),i.value?(p(),A("span",Z,[i.value.connected?(p(),x(C,{key:0,type:"success"},{default:o(()=>[m(" Connected - "+r(i.value.version)+" ("+r(i.value.latencyMs)+"ms) ",1)]),_:1})):(p(),x(C,{key:1,type:"danger"},{default:o(()=>[m(" Failed: "+r(i.value.error),1)]),_:1}))])):H("",!0)]),_:1})]),s("div",ee,[e[25]||(e[25]=s("h4",null,"Target GitLab",-1)),l(u,{label:"URL"},{default:o(()=>[l(y,{modelValue:t.gitlab.target.url,"onUpdate:modelValue":e[3]||(e[3]=n=>t.gitlab.target.url=n),placeholder:"http://localhost:9000"},null,8,["modelValue"])]),_:1}),l(u,{label:"Access Token"},{default:o(()=>[l(y,{modelValue:t.gitlab.target.token,"onUpdate:modelValue":e[4]||(e[4]=n=>t.gitlab.target.token=n),type:"password","show-password":"",placeholder:"glpat-****"},null,8,["modelValue"])]),_:1}),l(u,null,{default:o(()=>[l(_,{onClick:e[5]||(e[5]=n=>L("target")),loading:U.value},{default:o(()=>[...e[24]||(e[24]=[m(" Test Connection ",-1)])]),_:1},8,["loading"]),c.value?(p(),A("span",le,[c.value.connected?(p(),x(C,{key:0,type:"success"},{default:o(()=>[m(" Connected - "+r(c.value.version)+" ("+r(c.value.latencyMs)+"ms) ",1)]),_:1})):(p(),x(C,{key:1,type:"danger"},{default:o(()=>[m(" Failed: "+r(c.value.error),1)]),_:1}))])):H("",!0)]),_:1})])]),s("div",te,[e[28]||(e[28]=s("h3",null,"Scheduled Scan Settings",-1)),l(S),l(u,{label:"Enable Scheduled Scan"},{default:o(()=>[l(I,{modelValue:t.scanSettings.enabled,"onUpdate:modelValue":e[6]||(e[6]=n=>t.scanSettings.enabled=n)},null,8,["modelValue"])]),_:1}),l(u,{label:"Incremental Scan Interval"},{default:o(()=>[l(f,{modelValue:t.scanSettings.incrementalInterval,"onUpdate:modelValue":e[7]||(e[7]=n=>t.scanSettings.incrementalInterval=n),min:6e4,max:36e5,step:6e4},null,8,["modelValue"]),s("span",ne,"milliseconds ("+r(G(t.scanSettings.incrementalInterval))+")",1)]),_:1}),l(u,{label:"Full Scan Cron"},{default:o(()=>[l(y,{modelValue:t.scanSettings.fullScanCron,"onUpdate:modelValue":e[8]||(e[8]=n=>t.scanSettings.fullScanCron=n),placeholder:"0 0 2 * * ?"},null,8,["modelValue"]),e[27]||(e[27]=s("span",{class:"input-hint"},"Cron expression (e.g., 0 0 2 * * ? for daily at 2:00 AM)",-1))]),_:1})]),s("div",oe,[e[30]||(e[30]=s("h3",null,"Sync Settings",-1)),l(S),l(u,{label:"Sync Interval"},{default:o(()=>[l(f,{modelValue:t.syncSettings.syncInterval,"onUpdate:modelValue":e[9]||(e[9]=n=>t.syncSettings.syncInterval=n),min:60,max:3600,step:60},null,8,["modelValue"]),s("span",se,"seconds ("+r(M(t.syncSettings.syncInterval))+")",1)]),_:1}),l(u,{label:"Concurrency"},{default:o(()=>[l(f,{modelValue:t.syncSettings.concurrency,"onUpdate:modelValue":e[10]||(e[10]=n=>t.syncSettings.concurrency=n),min:1,max:20},null,8,["modelValue"]),e[29]||(e[29]=s("span",{class:"input-hint"},"Number of concurrent sync tasks",-1))]),_:1})]),s("div",ae,[e[34]||(e[34]=s("h3",null,"Default Sync Rules",-1)),l(S),l(u,{label:"Sync Method"},{default:o(()=>[l(j,{modelValue:t.defaultSyncRules.method,"onUpdate:modelValue":e[11]||(e[11]=n=>t.defaultSyncRules.method=n)},{default:o(()=>[l(F,{label:"Pull Sync",value:"pull_sync"}),l(F,{label:"Push Mirror",value:"push_mirror"})]),_:1},8,["modelValue"])]),_:1}),l(u,{label:"Exclude Archived"},{default:o(()=>[l(I,{modelValue:t.defaultSyncRules.excludeArchived,"onUpdate:modelValue":e[12]||(e[12]=n=>t.defaultSyncRules.excludeArchived=n)},null,8,["modelValue"]),e[31]||(e[31]=s("span",{class:"input-hint"},"Exclude archived projects from sync",-1))]),_:1}),l(u,{label:"Exclude Empty"},{default:o(()=>[l(I,{modelValue:t.defaultSyncRules.excludeEmpty,"onUpdate:modelValue":e[13]||(e[13]=n=>t.defaultSyncRules.excludeEmpty=n)},null,8,["modelValue"]),e[32]||(e[32]=s("span",{class:"input-hint"},"Exclude empty repositories from sync",-1))]),_:1}),l(u,{label:"Exclude Pattern"},{default:o(()=>[l(y,{modelValue:t.defaultSyncRules.excludePattern,"onUpdate:modelValue":e[14]||(e[14]=n=>t.defaultSyncRules.excludePattern=n),placeholder:"^temp/.*"},null,8,["modelValue"]),e[33]||(e[33]=s("span",{class:"input-hint"},"Regular expression to exclude projects by path",-1))]),_:1})]),s("div",ue,[e[37]||(e[37]=s("h3",null,"Thresholds",-1)),l(S),l(u,{label:"Delay Warning"},{default:o(()=>[l(f,{modelValue:t.thresholds.delayWarningHours,"onUpdate:modelValue":e[15]||(e[15]=n=>t.thresholds.delayWarningHours=n),min:1,max:168},null,8,["modelValue"]),e[35]||(e[35]=s("span",{class:"input-hint"},"hours",-1))]),_:1}),l(u,{label:"Delay Critical"},{default:o(()=>[l(f,{modelValue:t.thresholds.delayCriticalHours,"onUpdate:modelValue":e[16]||(e[16]=n=>t.thresholds.delayCriticalHours=n),min:1,max:720},null,8,["modelValue"]),e[36]||(e[36]=s("span",{class:"input-hint"},"hours",-1))]),_:1}),l(u,{label:"Max Retry Attempts"},{default:o(()=>[l(f,{modelValue:t.thresholds.maxRetryAttempts,"onUpdate:modelValue":e[17]||(e[17]=n=>t.thresholds.maxRetryAttempts=n),min:1,max:10},null,8,["modelValue"])]),_:1}),l(u,{label:"Timeout"},{default:o(()=>[l(f,{modelValue:t.thresholds.timeoutSeconds,"onUpdate:modelValue":e[18]||(e[18]=n=>t.thresholds.timeoutSeconds=n),min:60,max:1800},null,8,["modelValue"]),s("span",de,"seconds ("+r(M(t.thresholds.timeoutSeconds))+")",1)]),_:1})])]),_:1},8,["model"])]),_:1})])}}}),me=z(re,[["__scopeId","data-v-be942ed4"]]);export{me as default};
