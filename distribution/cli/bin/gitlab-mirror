#!/bin/bash
#
# GitLab Mirror CLI - Command Line Interface
#

set -e

# Get script directory
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
CLI_HOME="$(cd "$SCRIPT_DIR/.." && pwd)"
APP_HOME="$(cd "$CLI_HOME/.." && pwd)"

# Configuration
JAR_FILE="$CLI_HOME/lib/gitlab-mirror-cli.jar"
ENV_FILE="$APP_HOME/conf/.env"

# Java options for CLI (lighter than server)
JAVA_OPTS="${JAVA_OPTS:--Xms128m -Xmx512m}"

# Load environment variables
if [ -f "$ENV_FILE" ]; then
    set -a
    source "$ENV_FILE"
    set +a
fi

# Check JAR file exists
if [ ! -f "$JAR_FILE" ]; then
    echo "Error: CLI JAR file not found at $JAR_FILE"
    exit 1
fi

# Execute CLI with all arguments
java $JAVA_OPTS -jar "$JAR_FILE" "$@"
